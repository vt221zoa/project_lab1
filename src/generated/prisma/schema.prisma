generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "debian-openssl-3.0.x"]
  output        = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// Користувачі
model User {
  /// Ідентифікатор користувача
  id String @id @default(cuid())

  /// Унікальна почта користувача
  email    String @unique
  /// Пароль користувача
  password String
  /// Ім'я користувача
  name     String

  /// Ззображення користувача
  imageUrl  String?
  /// Чи є адміном користувач?
  isAdmin   Boolean  @default(false) // В подальшому розвитку сайту треба буде додати ролі для них
  /// Коли створений користувач?
  createdAt DateTime @default(now())
}

/// Аніме
model Anime {
  /// Ідентифікатор аніме
  id Int @id @default(autoincrement())

  /// Назва аніме українською
  titleUa String? @unique
  /// Назва аніме англійською
  titleEn String  @unique
  /// Назва аніме японською
  titleJp String? @unique

  /// Опис аніме
  description String?
  /// Віковий рейтинг аніме
  rating      String?
  /// Тип аніме (TV-серіал, Фільм і тощо)
  kind        String
  /// Кількість випущених серій в епізоді
  episodes    Int?
  /// Статус аніме (онгоїнг, вийшло, ще випускається)
  status      String
  /// Коли створене аніме
  dateRelease DateTime?

  /// Зображення аніме в URL
  imageUrl String?
  /// Студія яка виробляла це аніме
  studioId Int?
  studio   Studio?             @relation(fields: [studioId], references: [id])
  /// Жанри аніме
  genres   AnimeGenreOnAnime[]
}

/// Манга
model Manga {
  /// Ідентифікатор манги
  id Int @id @default(autoincrement())

  /// Назва манги українською
  titleUa String? @unique
  /// Назва манги англійскьою
  titleEn String  @unique
  /// Назва манги японською
  titleJp String? @unique

  /// Опис манги
  description String?
  /// Тип манги (Манга, Манхва і тощо)
  kind        String
  /// Кількість розділів в творі
  chapters    Int?
  /// Кількість томів в творі
  volumes     Int?
  /// Дата релізу манги
  dateRelease DateTime?
  /// Статус манги (Видається, Видано і тощо)
  status      String

  /// Зображення манги
  imageUrl    String?
  /// Видавництва які випускають мангу
  publisherId Int?
  publisher   Publisher?          @relation(fields: [publisherId], references: [id])
  /// Жанри
  genres      MangaGenreOnManga[]
}

/// Жанри аніме
model Genre {
  id     Int                 @id @default(autoincrement())
  /// Назва жанру
  name   String              @unique
  nameEn String?             @unique
  /// Зв'язок жанру і аніме
  animes AnimeGenreOnAnime[]
  mangas MangaGenreOnManga[]
}

/// Зв'язки аніме та жанрів
model AnimeGenreOnAnime {
  animeId Int
  anime   Anime @relation(fields: [animeId], references: [id])
  genreId Int
  genre   Genre @relation(fields: [genreId], references: [id])

  @@id([animeId, genreId])
}

/// Зв'язки манги та жанрів
model MangaGenreOnManga {
  mangaId Int
  manga   Manga @relation(fields: [mangaId], references: [id])
  genreId Int
  genre   Genre @relation(fields: [genreId], references: [id])

  @@id([mangaId, genreId])
}

/// Студія
model Studio {
  /// Ідентифікатор студії
  id      Int     @id @default(autoincrement())
  /// Назва студії
  name    String  @unique
  /// Зображення студії
  logoUrl String?
  /// Студії які виробляли аніме
  animes  Anime[]
}

/// Видавництва
model Publisher {
  /// Ідентифікатор видавництва
  id     Int     @id @default(autoincrement())
  /// Назва видавництва
  name   String  @unique
  /// Видавництва які видають манги
  mangas Manga[]
}
